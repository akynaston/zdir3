11/6/2024 11:56:50 AM
Ding these steps:

https://docs.google.com/document/d/1F9EZl2kXypShxZXsux0mRL-Pyw-0iUxOwQxzEHybHdA/edit?tab=t.0#heading=h.hc0jni6up0ew
# Goals
- Install and configure HAProxy
# Prepare the VMs
- Register your AM1 VM with Red Hat.
-sudo subscription-manager register --force
   
- You can register your AM2 VM as well, but that is not required right now.
- Download the TriVir Dev CA and server keypair.
- [https://ftp.trivir.com/outgoing/trivir/landl/ca.pem](https://ftp.trivir.com/outgoing/trivir/landl/ca.pem)
- Move to /etc/pki/ca-trust/source/trivirdev-ca.pem
- Run update-ca-trust
- Configure Chrome and Firefox to trust the CA.
- [https://ftp.trivir.com/outgoing/trivir/landl/serverpair.pem](https://ftp.trivir.com/outgoing/trivir/landl/serverpair.pem)
- Move to /etc/ssl/certs/serverpair.pem
11/6/2024 12:15:32 PM
 - done with above items, now doing haproxy
# Install HAProxy
- On the AM1 VM, install HAProxy.
- Follow steps 1-3 at [https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/7/html/load_balancer_administration/install_haproxy_example1#install_haproxy_example1](https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/7/html/load_balancer_administration/install_haproxy_example1#install_haproxy_example1)
- Step 4 was taken care of with the serverpair.pem.
- For step 5, download the haproxy config and move it to /etc/haproxy/haproxy.cfg.
- [https://ftp.trivir.com/outgoing/trivir/landl/haproxy.cfg](https://ftp.trivir.com/outgoing/trivir/landl/haproxy.cfg)
- The config assumes you have a hostname of am1.dev.trivir.com pointing to 172.17.2.75 and am2.dev.trivir.com pointing to 172.17.2.76 in your /etc/hosts file.
- Follow step 6.
# Test HAProxy
- Open Chrome or Firefox.
- Go to [https://people.dev.trivir.com/am](https://people.dev.trivir.com/am)
- You should enter your Login journey.
- Check the amlbcookie value (it should be 01 or 02)
- Do the same thing in the other browser.
- It should go to the journey again.
- Check the amlbcookie value (it should be the other value, but may not be)
**

presense of amlb cooie:
![[Pasted image 20241106122335.png]]Presense of amblcokie: in firefox

![[Pasted image 20241106122449.png]]
Didn't trust certs yet . .
