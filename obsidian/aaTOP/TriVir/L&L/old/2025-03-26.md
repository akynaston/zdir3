3/26/2025 12:02:49 PM

In Bravo realm: everyone set up their own idp, and their own circle of trust
idp name: akynaston-idp

Once IDP is created, then he'll spin up the SP container; he'll give us the metadata url, and go get SP meta data, setup an SP, akynaston-sp, then test it!

L&L tree - will need to set tree to use this tree.

Use: L&L AIC

	Now on nataive concle - 

https://openam-trivir.forgeblocks.com/am/ui-admin/#realms/%2Fbravo/dashboard

creatd akynasotn-cot, akynaston-idp, now advanced tab:
![[Pasted image 20250326121445.png]]

* remember to use a private window when testing . .

From Bryan in chat:
Aaron k - port 18

http://10.30.128.34:8018/spring-saml/logged-out.html

http://10.30.128.34:8018/spring-saml/saml/metadata


spring_saml_metadata.xml

<?xml version="1.0" encoding="UTF-8"?><md:EntityDescriptor xmlns:md="urn:oasis:names:tc:SAML:2.0:metadata" ID="akynaston-sp" entityID="akynaston-sp"><md:SPSSODescriptor AuthnRequestsSigned="false" WantAssertionsSigned="true" protocolSupportEnumeration="urn:oasis:names:tc:SAML:2.0:protocol"><md:SingleLogoutService Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" Location="http://10.30.128.34:8018/spring-saml/saml/SingleLogout"/><md:SingleLogoutService Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect" Location="http://10.30.128.34:8018/spring-saml/saml/SingleLogout"/><md:NameIDFormat>urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress</md:NameIDFormat><md:NameIDFormat>urn:oasis:names:tc:SAML:2.0:nameid-format:transient</md:NameIDFormat><md:NameIDFormat>urn:oasis:names:tc:SAML:2.0:nameid-format:persistent</md:NameIDFormat><md:NameIDFormat>urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified</md:NameIDFormat><md:NameIDFormat>urn:oasis:names:tc:SAML:1.1:nameid-format:X509SubjectName</md:NameIDFormat><md:AssertionConsumerService Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" Location="http://10.30.128.34:8018/spring-saml/saml/SSO" index="0" isDefault="true"/><md:AssertionConsumerService Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Artifact" Location="http://10.30.128.34:8018/spring-saml/saml/SSO" index="1"/></md:SPSSODescriptor></md:EntityDescriptor>


now, from bryan:
Brian Holderness

  
Discussion on how SAML file above was given to us from Brian:
https://openam-trivir.forgeblocks.com/am/saml2/jsp/exportmetadata.jsp?realm=/bravo&entityid=jseaver-idp (or akynaston-idp)

https://openam-trivir.forgeblocks.com/am/saml2/jsp/exportmetadata.jsp?realm=/bravo&entityid=akynaston-idp


now:
![[Pasted image 20250326122711.png]]

Now added idp and sp to COT . . can't get idp in . .

through COT added it, now loggin gin private browser
http://10.30.128.34:8018/spring-saml/logged-out.html

now arrived at: http://10.30.128.34:8018/spring-saml/

Back at the sp config
![[Pasted image 20250326123710.png]]

logged back in to logout link again above, got 401, had to go in again

http://10.30.128.34:8018/spring-saml/

got this in private browser:
[Logout](http://10.30.128.34:8018/spring-saml/saml/logout)

# User Details

userName: bholderness@example.com

token: ExpiringUsernameAuthenticationToken [Principal=bholderness@example.com, Credentials=[PROTECTED], Authenticated=true, Details=null, Granted Authorities=[]]

principal: bholderness@example.com

Assertion:

<?xml version="1.0" encoding="UTF-8"?><saml:Assertion xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion" ID="s29fe3d86b67d1d2a1ad9a1620675bc377609cb7ad" IssueInstant="2025-03-26T18:40:34.000Z" Version="2.0" xmlns:xs="http://www.w3.org/2001/XMLSchema">
   <saml:Issuer>akynaston-idp</saml:Issuer>
   <ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
      <ds:SignedInfo>
         <ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
         <ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"/>
         <ds:Reference URI="#s29fe3d86b67d1d2a1ad9a1620675bc377609cb7ad">
            <ds:Transforms>
               <ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
               <ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#">
                  <ec:InclusiveNamespaces xmlns:ec="http://www.w3.org/2001/10/xml-exc-c14n#" PrefixList="xs"/>
               </ds:Transform>
            </ds:Transforms>
            <ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
            <ds:DigestValue/>
         </ds:Reference>
      </ds:SignedInfo>
      <ds:SignatureValue/>
      <ds:KeyInfo>
         <ds:X509Data>
            <ds:X509Certificate>MIIDYzCCAkugAwIBAgIIXAka5XEf+IUwDQYJKoZIhvcNAQELBQAwYDELMAkGA1UEBhMCVUsxEDAOBgNVBAgTB0JyaXN0b2wxEDAOBgNVBAcTB0JyaXN0b2wxEjAQBgNVBAoTCUZvcmdlUm9jazEZMBcGA1UEAxMQcnNhand0c2lnbmluZ2tleTAeFw0yNDA4MTUxNzMyMDBaFw0zNDA4MTMxNzMyMDBaMGAxCzAJBgNVBAYTAlVLMRAwDgYDVQQIEwdCcmlzdG9sMRAwDgYDVQQHEwdCcmlzdG9sMRIwEAYDVQQKEwlGb3JnZVJvY2sxGTAXBgNVBAMTEHJzYWp3dHNpZ25pbmdrZXkwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCtZFVmj9rYUAUWEqkbQC1OhuHzTkPESjbDWpGj7ZG5GDm2uNw36dSZIw2GbCckVvkJmPAEY3MqOSenKJdsa715hq6ubj9T8bwmMNY0A9XJtprp763eype1+e+3lJj5QXe5t9aewKRLQbuYrxz6ywPJOn/nbXU+/LxEvIbSQdUMlZ9CBKnDGF7B+hGdUgQR2BpNBbinDeyoA3NzuUgxxhTrkfGE6FehTfECjqdfGLlXBvIR9XWXegyBu95xrMkaAVKgAf06aDKqS8p8lDdQIAzB6LA5jaUXY0TSVA0gRYHI72rFMQGjVoMNCLXxD5oQnhTO0MIOyWAmeSwRobBre8c9AgMBAAGjITAfMB0GA1UdDgQWBBTmO7q2jwH1IXCZhacXYxSbgbjimTANBgkqhkiG9w0BAQsFAAOCAQEAj6nXkuexubHtdOcyZZk95MKf+Cm0kYTUNaeb1IVK9cnB9Z6Ju6Ty0YK4dvl/urCwlU8zfrBvRYyZkbcaeUD6Lhkgsh6FDJwvEPsUFYDWL3st1RN4uYjXi1CG+VjbbxkRtYC5j3N1Dq1Vxk29PZGCEHQ0aDNeIVOvKWGn+7QKdIdXwVpA1CbhBY2/je/FKF+6T0mLHaLaaQ8WcZkq4JjcIRxONJyPIYEICR6gFJcwMcwHGVHh6K4I/Z+r5N8pl/ApCOKQngjj1lDF2tNBtywTkD859BLvVOg8hnw5m8X9+ZT1TRtsjldnhaZ69GSc6HEEw/pVDUVTxsBojWGIbAOVuw==</ds:X509Certificate>
         </ds:X509Data>
      </ds:KeyInfo>
   </ds:Signature>
   <saml:Subject>
      <saml:NameID Format="urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress" NameQualifier="akynaston-idp" SPNameQualifier="akynaston-sp">bholderness@example.com</saml:NameID>
      <saml:SubjectConfirmation Method="urn:oasis:names:tc:SAML:2.0:cm:bearer">
         <saml:SubjectConfirmationData InResponseTo="a4dhbbcjbheig2455189gg8c5913044" NotOnOrAfter="2025-03-26T18:50:34.000Z" Recipient="http://10.30.128.34:8018/spring-saml/saml/SSO"/>
      </saml:SubjectConfirmation>
   </saml:Subject>
   <saml:Conditions NotBefore="2025-03-26T18:30:34.000Z" NotOnOrAfter="2025-03-26T18:50:34.000Z">
      <saml:AudienceRestriction>
         <saml:Audience>akynaston-sp</saml:Audience>
      </saml:AudienceRestriction>
   </saml:Conditions>
   <saml:AuthnStatement AuthnInstant="2025-03-26T18:40:34.000Z" SessionIndex="s2bfb32de6475de4663ddcbf24449c7bdabe557101">
      <saml:AuthnContext>
         <saml:AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:unspecified</saml:AuthnContextClassRef>
      </saml:AuthnContext>
   </saml:AuthnStatement>
   <saml:AttributeStatement>
      <saml:Attribute Name="First name">
         <saml:AttributeValue xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">Brian</saml:AttributeValue>
      </saml:Attribute>
      <saml:Attribute Name="lastname">
         <saml:AttributeValue xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">Holderness</saml:AttributeValue>
      </saml:Attribute>
   </saml:AttributeStatement>
</saml:Assertion>

notice 'First name', 'lastname'

all communication is happening through browser! sp & idp don't have to be on the same network!
See name-idformat is email address

  apparently the default: emailAddress:
      <saml:NameID Format="urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress" NameQualifier="akynaston-idp" SPNameQualifier="akynaston-sp">bholderness@example.com</saml:NameID>


Testing; then did some name-format re-organization . .
