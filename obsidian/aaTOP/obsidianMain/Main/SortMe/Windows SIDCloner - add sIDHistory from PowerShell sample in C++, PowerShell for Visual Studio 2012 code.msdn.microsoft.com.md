# Windows SIDCloner - add sIDHistory from PowerShell sample in C++, PowerShell for Visual Studio 2012 [code.msdn.microsoft.com]

[![[./_resources/Windows_SIDCloner_-_add_sIDHistory_from_PowerShell_sample_in_C++,_PowerShell_for_Visual_Studio_2012_code.msdn.microsoft.com.resources/Windows_logo.png]]](https://msdn.microsoft.com/windows/desktop)
[[#|Dev Center - Desktop]]

[Dashboard](https://sysdev.microsoft.com/en-us/desktop/) [Get started](http://msdn.microsoft.com/windows/desktop/bg161546.aspx) [Design](http://msdn.microsoft.com/windows/desktop/aa511258.aspx) [Develop](http://msdn.microsoft.com/windows/desktop/aa904962.aspx) [Test and deploy](http://msdn.microsoft.com/windows/desktop/dn553326.aspx) [Certify](http://msdn.microsoft.com/windows/desktop/jj134964.aspx)

<https://code.msdn.microsoft.com/windowsdesktop/SIDCloner-add-sIDHistory-831ae24b>[Sign in](https://login.live.com/login.srf?wa=wsignin1.0&wtrealm=code.msdn.microsoft.com&wreply=https%3a%2f%2fcode.msdn.microsoft.com%2fwindowsdesktop%2fSIDCloner-add-sIDHistory-831ae24b%3fstoAI%3d10&wp=MBI_FED_SSL&wlcxt=microsoft%24microsoft%24microsoft)

[Desktop technologies](http://msdn.microsoft.com/en-us/library/windows/desktop/bg126469.aspx) [Server and system](http://msdn.microsoft.com/en-us/library/windows/desktop/bg125390.aspx) [API index](http://msdn.microsoft.com/en-us/library/windows/desktop/hh920508(vs.85).aspx) [Samples](http://code.msdn.microsoft.com/windowsdesktop/) [Community](http://msdn.microsoft.com/windows/desktop/aa904945.aspx)

[Dev Center - Desktop](https://msdn.microsoft.com/en-US/windows/desktop/default)
\>
[Samples](https://code.msdn.microsoft.com/windowsdesktop/)
\>
[SIDCloner - add sIDHistory from PowerShell](https://code.msdn.microsoft.com/windowsdesktop/SIDCloner-add-sIDHistory-831ae24b)

[![[./_resources/Windows_SIDCloner_-_add_sIDHistory_from_PowerShell_sample_in_C++,_PowerShell_for_Visual_Studio_2012_code.msdn.microsoft.com.resources/download.png]]Get SDK and tools](http://msdn.microsoft.com/windows/desktop/aa904949)

### Quick access

[My samples](https://code.msdn.microsoft.com/windowsdesktop/site/mydashboard)

[Upload a sample](https://code.msdn.microsoft.com/windowsdesktop/site/upload)
[Browse sample requests](https://code.msdn.microsoft.com/windowsdesktop/site/requests)

|     |     |
| --- | --- |
| [![[./_resources/Windows_SIDCloner_-_add_sIDHistory_from_PowerShell_sample_in_C++,_PowerShell_for_Visual_Studio_2012_code.msdn.microsoft.com.resources/avatar.jpg]]](https://social.msdn.microsoft.com/profile/jiri%20formacek%20-%20msft/) | 6,295<br><br>Points<br>Top 1% |

|     |     |
| --- | --- |
| [Jiri Formacek - MSFT](https://social.msdn.microsoft.com/profile/jiri%20formacek%20-%20msft/) |     |
|     | Joined Jan 2009 |
|     |     |
| 1<br><br>3 | [View samples](https://code.msdn.microsoft.com/windowsdesktop/site/search?f%5B0%5D.Type=User&f%5B0%5D.Value=Jiri%20Formacek%20-%20MSFT)<br>[Show activity](https://social.msdn.microsoft.com/profile/jiri%20formacek%20-%20msft/activity) |

### More from Jiri Formacek - MSFT

[Local admin password management solution](https://code.msdn.microsoft.com/windowsdesktop/Solution-for-management-of-ae44e789)
     ![[./_resources/Windows_SIDCloner_-_add_sIDHistory_from_PowerShell_sample_in_C++,_PowerShell_for_Visual_Studio_2012_code.msdn.microsoft.com.resources/trans.gif]] ![[./_resources/Windows_SIDCloner_-_add_sIDHistory_from_PowerShell_sample_in_C++,_PowerShell_for_Visual_Studio_2012_code.msdn.microsoft.com.resources/trans.gif]] ![[./_resources/Windows_SIDCloner_-_add_sIDHistory_from_PowerShell_sample_in_C++,_PowerShell_for_Visual_Studio_2012_code.msdn.microsoft.com.resources/trans.gif]] ![[./_resources/Windows_SIDCloner_-_add_sIDHistory_from_PowerShell_sample_in_C++,_PowerShell_for_Visual_Studio_2012_code.msdn.microsoft.com.resources/trans.gif]] ![[./_resources/Windows_SIDCloner_-_add_sIDHistory_from_PowerShell_sample_in_C++,_PowerShell_for_Visual_Studio_2012_code.msdn.microsoft.com.resources/trans.gif]](37)

[ManageDHCP - Manage your DHCP server from Powershell and ASP.NET](https://code.msdn.microsoft.com/windowsdesktop/ManageDHCP-Manage-your-6bb4f69f)
     ![[./_resources/Windows_SIDCloner_-_add_sIDHistory_from_PowerShell_sample_in_C++,_PowerShell_for_Visual_Studio_2012_code.msdn.microsoft.com.resources/trans.gif]] ![[./_resources/Windows_SIDCloner_-_add_sIDHistory_from_PowerShell_sample_in_C++,_PowerShell_for_Visual_Studio_2012_code.msdn.microsoft.com.resources/trans.gif]] ![[./_resources/Windows_SIDCloner_-_add_sIDHistory_from_PowerShell_sample_in_C++,_PowerShell_for_Visual_Studio_2012_code.msdn.microsoft.com.resources/trans.gif]] ![[./_resources/Windows_SIDCloner_-_add_sIDHistory_from_PowerShell_sample_in_C++,_PowerShell_for_Visual_Studio_2012_code.msdn.microsoft.com.resources/trans.gif]] ![[./_resources/Windows_SIDCloner_-_add_sIDHistory_from_PowerShell_sample_in_C++,_PowerShell_for_Visual_Studio_2012_code.msdn.microsoft.com.resources/trans.gif]](3)

[How to parse Network monitor capture file from Powershell](https://code.msdn.microsoft.com/windowsdesktop/How-to-parse-Network-f6162019)
     ![[./_resources/Windows_SIDCloner_-_add_sIDHistory_from_PowerShell_sample_in_C++,_PowerShell_for_Visual_Studio_2012_code.msdn.microsoft.com.resources/trans.gif]] ![[./_resources/Windows_SIDCloner_-_add_sIDHistory_from_PowerShell_sample_in_C++,_PowerShell_for_Visual_Studio_2012_code.msdn.microsoft.com.resources/trans.gif]] ![[./_resources/Windows_SIDCloner_-_add_sIDHistory_from_PowerShell_sample_in_C++,_PowerShell_for_Visual_Studio_2012_code.msdn.microsoft.com.resources/trans.gif]] ![[./_resources/Windows_SIDCloner_-_add_sIDHistory_from_PowerShell_sample_in_C++,_PowerShell_for_Visual_Studio_2012_code.msdn.microsoft.com.resources/trans.gif]] ![[./_resources/Windows_SIDCloner_-_add_sIDHistory_from_PowerShell_sample_in_C++,_PowerShell_for_Visual_Studio_2012_code.msdn.microsoft.com.resources/trans.gif]](4)

[Allow exception to Restricted Groups feature of GPO](https://code.msdn.microsoft.com/windowsdesktop/ManagedBy-51527a60)
     ![[./_resources/Windows_SIDCloner_-_add_sIDHistory_from_PowerShell_sample_in_C++,_PowerShell_for_Visual_Studio_2012_code.msdn.microsoft.com.resources/trans.gif]] ![[./_resources/Windows_SIDCloner_-_add_sIDHistory_from_PowerShell_sample_in_C++,_PowerShell_for_Visual_Studio_2012_code.msdn.microsoft.com.resources/trans.gif]] ![[./_resources/Windows_SIDCloner_-_add_sIDHistory_from_PowerShell_sample_in_C++,_PowerShell_for_Visual_Studio_2012_code.msdn.microsoft.com.resources/trans.gif]] ![[./_resources/Windows_SIDCloner_-_add_sIDHistory_from_PowerShell_sample_in_C++,_PowerShell_for_Visual_Studio_2012_code.msdn.microsoft.com.resources/trans.gif]] ![[./_resources/Windows_SIDCloner_-_add_sIDHistory_from_PowerShell_sample_in_C++,_PowerShell_for_Visual_Studio_2012_code.msdn.microsoft.com.resources/trans.gif]](2)

# SIDCloner - add sIDHistory from PowerShell

## ThisÂ sample is managed class library that implements single class: SIDCloner specialized for migration of SID History. Sample is standalone; ADMT is not required to be installed.

Download
[C++ (83.7 KB)](https://code.msdn.microsoft.com/windowsdesktop/SIDCloner-add-sIDHistory-831ae24b/file/95468/5/SIDCloner%20-%20add%20sIDHistory%20from%20PowerShell.zip)

Ratings

(3)

Downloaded 2,167 times
Favorites [Add to favorites](https://login.live.com/login.srf?wa=wsignin1.0&wtrealm=code.msdn.microsoft.com&wreply=https%3a%2f%2fcode.msdn.microsoft.com%2fwindowsdesktop%2fSIDCloner-add-sIDHistory-831ae24b%3fstoAI%3d10&wp=MBI_FED_SSL&wlcxt=microsoft%24microsoft%24microsoft)
Requires
[Visual Studio 2012](https://code.msdn.microsoft.com/windowsdesktop/site/search?f%5B0%5D.Type=VisualStudioVersion&f%5B0%5D.Value=11.0&f%5B0%5D.Text=Visual%20Studio%202012)

Updated 12/6/2014
License
[[#|Apache License, Version 2.0]]

Share    [![[./_resources/Windows_SIDCloner_-_add_sIDHistory_from_PowerShell_sample_in_C++,_PowerShell_for_Visual_Studio_2012_code.msdn.microsoft.com.resources/email.gif]]](https://code.msdn.microsoft.com/windowsdesktop/SIDCloner-add-sIDHistory-831ae24bmailto:?subject=SIDCloner%20-%20add%20sIDHistory%20from%20PowerShell&Body=https://code.msdn.microsoft.com/windowsdesktop/SIDCloner-add-sIDHistory-831ae24b) [![[./_resources/Windows_SIDCloner_-_add_sIDHistory_from_PowerShell_sample_in_C++,_PowerShell_for_Visual_Studio_2012_code.msdn.microsoft.com.resources/twitter.gif]]](http://twitter.com/home?status=SIDCloner%20-%20add%20sIDHistory%20from%20PowerShell%20:%20https%3a%2f%2fcode.msdn.microsoft.com%2fwindowsdesktop%2fSIDCloner-add-sIDHistory-831ae24b) [![[./_resources/Windows_SIDCloner_-_add_sIDHistory_from_PowerShell_sample_in_C++,_PowerShell_for_Visual_Studio_2012_code.msdn.microsoft.com.resources/delicious.gif]]](http://del.icio.us/post?url=https%3a%2f%2fcode.msdn.microsoft.com%2fwindowsdesktop%2fSIDCloner-add-sIDHistory-831ae24b&title=SIDCloner%20-%20add%20sIDHistory%20from%20PowerShell) [![[./_resources/Windows_SIDCloner_-_add_sIDHistory_from_PowerShell_sample_in_C++,_PowerShell_for_Visual_Studio_2012_code.msdn.microsoft.com.resources/digg.gif]]](http://digg.com/submit?url=https%3a%2f%2fcode.msdn.microsoft.com%2fwindowsdesktop%2fSIDCloner-add-sIDHistory-831ae24b&title=SIDCloner%20-%20add%20sIDHistory%20from%20PowerShell) [![[./_resources/Windows_SIDCloner_-_add_sIDHistory_from_PowerShell_sample_in_C++,_PowerShell_for_Visual_Studio_2012_code.msdn.microsoft.com.resources/facebook.gif]]](http://www.facebook.com/sharer.php?u=https%3a%2f%2fcode.msdn.microsoft.com%2fwindowsdesktop%2fSIDCloner-add-sIDHistory-831ae24b&t=SIDCloner%20-%20add%20sIDHistory%20from%20PowerShell)

Technologies
[Active Directory](https://code.msdn.microsoft.com/windowsdesktop/site/search?f%5B0%5D.Type=Technology&f%5B0%5D.Value=Active%20Directory&f%5B0%5D.Text=Active%20Directory)

Topics
[Security](https://code.msdn.microsoft.com/windowsdesktop/site/search?f%5B0%5D.Type=Topic&f%5B0%5D.Value=Security&f%5B0%5D.Text=Security)

[Report abuse to Microsoft](https://login.live.com/login.srf?wa=wsignin1.0&wtrealm=code.msdn.microsoft.com&wreply=https%3a%2f%2fcode.msdn.microsoft.com%2fwindowsdesktop%2fSIDCloner-add-sIDHistory-831ae24b%2fview%2fReportAbuse%3fstoAI%3d10&wp=MBI_FED_SSL&wlcxt=microsoft%24microsoft%24microsoft)

[Description](https://code.msdn.microsoft.com/windowsdesktop/SIDCloner-add-sIDHistory-831ae24b#content)
[Browse code](https://code.msdn.microsoft.com/windowsdesktop/SIDCloner-add-sIDHistory-831ae24b/view/SourceCode#content)
[Q and A (16)](https://code.msdn.microsoft.com/windowsdesktop/SIDCloner-add-sIDHistory-831ae24b/view/Discussions#content)

Attachments:
[SIDCloner_binaries.zip](https://code.msdn.microsoft.com/windowsdesktop/SIDCloner-add-sIDHistory-831ae24b/file/130803/1/SIDCloner_binaries.zip)

Centers

* [Windows Dev Center](http://dev.windows.com/)

* [Desktop](http://msdn.microsoft.com/windows/desktop)
* [Hardware](http://msdn.microsoft.com/windows/hardware)
* [Internet Explorer](http://msdn.microsoft.com/ie)

Related developer sites

* [Microsoft Connect](http://go.microsoft.com/fwlink/p/?linkid=285622)

* [.NET Framework](http://go.microsoft.com/fwlink/p/?linkid=285623)
* [Visual Studio](http://go.microsoft.com/fwlink/p/?linkid=282089)
* [Windows Server](http://go.microsoft.com/fwlink/p/?linkid=282087)

Other Windows sites

* [Enterprise](http://go.microsoft.com/fwlink/p/?linkid=280294)

* [Small business](http://go.microsoft.com/fwlink/p/?linkid=280295)
* [Students](http://go.microsoft.com/fwlink/p/?linkid=280296)
* [Home users](http://go.microsoft.com/fwlink/p/?linkid=280297)

Downloads

* [Windows 8.1](http://go.microsoft.com/fwlink/p/?linkid=267554)

* [Windows SDK](http://go.microsoft.com/fwlink/p/?linkid=328183)
* [Visual Studio Express 2013](http://go.microsoft.com/fwlink/p/?linkid=316619)
* [More downloads](http://go.microsoft.com/fwlink/p/?linkid=285626)

Support

* [Forums](http://go.microsoft.com/fwlink/p/?linkid=285632)

* [More support options](http://go.microsoft.com/fwlink/p/?linkid=285633)

Essentials

* [Windows APIs](http://go.microsoft.com/fwlink/p/?linkid=285627)

* [Samples](http://go.microsoft.com/fwlink/p/?linkid=285628)
* [Compatibility and certification](http://go.microsoft.com/fwlink/p/?linkid=285629)
* [Desktop dashboard](http://go.microsoft.com/fwlink/p/?linkid=285630)

Stay connected

* [Microsoft events](http://go.microsoft.com/fwlink/p/?linkid=285954)

* [Building Apps for Windows Devices](http://go.microsoft.com/fwlink/p/?linkid=313895)
<https://msdn.microsoft.com/en-US>

Â© 2015 Microsoft

* [Privacy and Cookies](http://go.microsoft.com/fwlink/?LinkId=248681)

* [Terms of Use](http://go.microsoft.com/fwlink/p/?linkid=248155)
* [Trademarks](http://go.microsoft.com/fwlink/p/?linkid=248154)
* [Site map](http://go.microsoft.com/fwlink/p/?LinkId=400453)
Hello from Seattle.
[[#|English]]
