# Microsoft PowerShell variables | The $_. variable

|     |     |
| --- | --- |
| [Site Home](http://www.computerperformance.co.uk/index.htm) | ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/arrow.gif]] |

 

|     |     |
| --- | --- |
| [Scripts VBScript et al](http://www.computerperformance.co.uk/vbscript/index.htm) | ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/arrow.gif]] |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [PowerShell Home](http://www.computerperformance.co.uk/powershell/index.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [PowerShell Ebook](http://www.computerperformance.co.uk/Poll/Sales_PowerShell.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [PowerShell Introduction](http://www.computerperformance.co.uk/powershell/powershell_intro.htm) |

 

|     |     |     |
| --- | --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [PowerShell Techniques](http://www.computerperformance.co.uk/powershell/index_techniques.htm) | ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/arrow.gif]] |

 

|     |     |     |
| --- | --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [Real Life Tasks](http://www.computerperformance.co.uk/powershell/index_real_life.htm) | ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/arrow.gif]] |

  

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/tridown.gif]] | [PowerShell Syntax](http://www.computerperformance.co.uk/powershell/index_syntax.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [Add-content](http://www.computerperformance.co.uk/powershell/powershell_files_add_content.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [Backtick](http://www.computerperformance.co.uk/powershell/powershell_backtick.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [Brackets () {} and](http://www.computerperformance.co.uk/powershell/powershell_brackets.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [Drives](http://www.computerperformance.co.uk/powershell/powershell_drives.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [Conditional Operators](http://www.computerperformance.co.uk/powershell/powershell_conditional_operators.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [Compare-Object](http://www.computerperformance.co.uk/powershell/powershell_compare_object.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [Format-table (ft)](http://www.computerperformance.co.uk/powershell/powershell_format_table.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [-f Format Operator](http://www.computerperformance.co.uk/powershell/powershell_-f_format.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [Get-Member](http://www.computerperformance.co.uk/powershell/powershell_get_member.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [Group-Object](http://www.computerperformance.co.uk/powershell/powershell_group_object.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [If and ElseIf](http://www.computerperformance.co.uk/powershell/powershell_if_statement.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [-Match and -NotMatch](http://www.computerperformance.co.uk/powershell/powershell_match.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [Out-File](http://www.computerperformance.co.uk/powershell/powershell_out_file.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [Parameter (-switch)](http://www.computerperformance.co.uk/powershell/powershell_10_parameters_switches.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [Pipeline (\|)(¦) and $_](http://www.computerperformance.co.uk/powershell/powershell_pipeline.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [Quotes 'Single' Dbl?](http://www.computerperformance.co.uk/powershell/powershell_quotes.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [Recurse](http://www.computerperformance.co.uk/powershell/powershell_recurse.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [Recurse](http://www.computerperformance.co.uk/powershell/powershell_recurse.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [Regex Reg Expression](http://www.computerperformance.co.uk/powershell/powershell_regex.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [Select-string](http://www.computerperformance.co.uk/powershell/powershell_select_string.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [Switch](http://www.computerperformance.co.uk/powershell/powershell_switch.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [Syntax](http://www.computerperformance.co.uk/powershell/powershell_syntax.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [Variables](http://www.computerperformance.co.uk/powershell/powershell_variables.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [Whatif & Confirm](http://www.computerperformance.co.uk/powershell/powershell_whatif_confirm.htm) |

  

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [PowerShell Verbs](http://www.computerperformance.co.uk/powershell/powershell_verbs.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [PowerShell Nouns](http://www.computerperformance.co.uk/powershell/powershell_nouns.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [PowerShell Tips](http://www.computerperformance.co.uk/powershell/powershell_tips.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [.NET Framework](http://www.computerperformance.co.uk/powershell/net_framework.htm) |

 

|     |     |
| --- | --- |
| ![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/buttonMilonice.gif]] | [PowerShell Download](http://www.computerperformance.co.uk/powershell/powershell_download.htm) |

[![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/PAL50Bare.jpg]]](http://www.computerperformance.co.uk/index.htm)

[![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/sail125x125b.gif]]](http://www.3cx.com/)

[3CX Phone System for Windows](http://www.3cx.com/phone-system) -
[VOIP IP PBX](http://www.3cx.com/)

* * *

[![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/AS_Citrix_125x125.gif]]](http://www.2x.com/applicationserver/citrix.htm)

[Application Publishing](http://www.2x.com/applicationserver) with [2X ApplicationServer](http://www.2x.com/applicationserver)

* * *

|     |
| --- |
|     |
| [![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/Logo_25wht.gif]]](http://www.computerperformance.co.uk/powershell/index.htm) |

[![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/ipam_subnet_sm.jpg]]](http://www.solarwinds.com/register/index.aspx?Program=911&c=70150000000Emdt&CMP=BIZ-TAD-CPP-IPAM-DL)

[IPAM](http://www.solarwinds.com/register/index.aspx?Program=911&c=70150000000Emdt&CMP=BIZ-TAD-CPP-IPAM-DL) will assist you in managing IP addresses.

To let you into a secret, this utilities is fun to use, even if you don't have a pressing need to calculate your IP address space.

Get a free evaluation copy of [Orion IPAM](http://www.solarwinds.com/register/index.aspx?Program=911&c=70150000000Emdt&CMP=BIZ-TAD-CPP-IPAM-DL)

* * *

### [Guy's Top 10 Free Tools](http://www.computerperformance.co.uk/HealthCheck/tools_top_10.htm)

[1) FreePing](http://www.computerperformance.co.uk/HealthCheck/tools_top_10.htm#FreePing)
[2) Orion NPM 9.5](http://www.computerperformance.co.uk/HealthCheck/tools_top_10.htm#Orion_NPM)
[3) Xobni](http://www.computerperformance.co.uk/HealthCheck/tools_top_10.htm#Xobni_(Inbox_spelt_backwards))
[4) PuTTY (UNIX)](http://www.computerperformance.co.uk/HealthCheck/tools_top_10.htm#PuTTY)
[5) IP SLA Monitor](http://www.computerperformance.co.uk/HealthCheck/tools_top_10.htm#Free_IP_SLA_Monitor)
[6) BgInfo](http://www.computerperformance.co.uk/HealthCheck/tools_top_10.htm#BGINFO)
[7) Net-SNMP](http://www.computerperformance.co.uk/HealthCheck/tools_top_10.htm#Net-SNMP)
[8) CatTools](http://www.computerperformance.co.uk/HealthCheck/tools_top_10.htm#CatTools_(Free_device_backup_utility))
[9) Exchange Monitor](http://www.computerperformance.co.uk/HealthCheck/tools_top_10.htm#Exchange_Monitor)
[10) WinDiff](http://www.computerperformance.co.uk/HealthCheck/tools_top_10.htm#WinDiff)

# Windows PowerShell Variables

## Introduction to Windows PowerShell Variables

All scripting languages use placeholders or variables to hold data.  Moreover, each language has its own rules and symbols.  I have found that using any PowerShell variable is straightforward, just remember that PowerShell introduces variables with a dollar sign, for example: $memory.

What impresses programmers is the ability to assign not just text to the variable, but also to assign an object to a variable.  While most proper scripting languages are able to handle objects through variables, CMD lacks this ability.

### Topics for PowerShell's Variables

* [$Dollar variables](http://www.computerperformance.co.uk/powershell/powershell_variables.htm#$Dollar_variables_)
* [Set-Variable, Scope and Option](http://www.computerperformance.co.uk/powershell/powershell_variables.htm#Set-Variable,_Scope_and_Option._)
* [PowerShell's Dot Properties](http://www.computerperformance.co.uk/powershell/powershell_variables.htm#Monads_Dot_Properties._)
* [Special Pipeline Variable:](http://www.computerperformance.co.uk/powershell/powershell_variables.htm#Special_$__Variable)  **$\_.**
* [More PowerShell Variables](http://www.computerperformance.co.uk/powershell/powershell_variables.htm#More_Variables_)
* [Summary of PowerShell Variables](http://www.computerperformance.co.uk/powershell/powershell_variables.htm#Summary_of_Monad_Variables_)

   ♣

### PowerShell's 

Creating a PowerShell variable could not be more straightforward; just put the dollar sign in front of the name you wish to call the variable.  Let us create, then set, a variable called $Mem:

$Mem= WmiObject Win32\_ComputerSystem

Once we have created $Mem, then we can put the variable to work and calculate the RAM memory in Mega bytes.

$Mem= WmiObject Win32\_ComputerSystem
$Mbyte =1048576  # Another variable
"Memory Mbyte " + \[int\](**$Mem**.TotalPhysicalMemory/$Mbyte)

PowerShell has no built-in mechanism for enforcing variable types, for example, string variables can begin with letters or numbers. Yet numeric variables can also begin with letters (or numbers). However, you can restrict the values a PowerShell variable accepts by preceding it with \[int\] or \[string\], for example:

**Example declaring the PowerShell variable as an integer**

\[int\]$a =7

$a +3
$a
10

$a ="Twenty"
$a
Error "Cannot Convert value.

**Note:** I cannot resist pointing out the \[Square brackets\].  The reason is that PowerShell only ever uses square brackets for optional items, and declaring the type of a variable is just that - optional.

**Example without declaring the variable type.**

$b = 7
$b = "Twenty"
$b
Twenty

No error here because $b was not declared as number or a string.

Do you think that PowerShell variables are case sensitive or insensitive?  The answer is insensitive, just as with most other commands, upper or lower case work equally.

When PowerShell evaluates a potential variable name, it carries on from the $Dollar until it meets a word breaking character such as a space or punctuation mark.  This gives me no problem because I only use snappy OneWord names, but if you use variables with strange characters - watch out!  If you insist on using variables with names such as a\*?,v\*\*, then you could enclose them in braces - thus {a\*?,v\*\*}.  Clever stuff, but best to keep it simple and don't ask for trouble I say.

Incidentally, you can join string variables simply by using a plus (+) sign. The reason that I mention this is because I spent ages searching fruitlessly for a special text concatenator, only to discover that the plain plus sign was all I needed.

  ˚

### 

You can control, or restrict, PowerShell variables with the set-variable command.  These extra properties of 'Option' and 'Scope' are not really necessary for beginners, nevertheless as you grow in ambition, you may like to revisit these additional features.

**Option** can set the variable to be read-only or constant.  Constant variables sound strange, but their killer feature is they cannot be deleted.

Example: set-variable Thermometer 32 -option constant.

Note that when initializing with set-variable, $Thermometer is wrong, plain Thermometer is what you need here.  Once the value is set to 32 it cannot be changed.

**Scope** can be local, global or script.  The default value for the scope of a variable is local.

Example: set-variable AllOverPlace 99 -scope global.

**Note:** The value would be 99, again you don't add the $dollar sign when you execute set-variable.  Actually, there is an alternative method for setting and creating Scope:

$global:runners = 8

Note this time you start with a dollar and employ the equals sign.

### 

PowerShell variables support the dot (.) properties.  For example:

$alert = Get-service alerter
$alert.status

Result at the PowerShell command line:
Stopped

Not only is $variable.property a neat technique, but Get-service alerter.status does not work, you get an error saying: 'Cannot find any service called alerter.status'.

### 

$\_ or $\_. takes the dot notation one stage further.  It acts a placeholder for the current object.  The official definition for $\_. is the current pipeline object; used in script blocks, filters, the process clause of functions, where-object, foreach-object and switches.  However, I believe that special PowerShell variable $\_. is best explained by examples.

**PowerShell Example to find all services that are Running (not stopped)**

get-service | where {$\_.status -eq "Running" }

Remember that this get-service command lists all those services on the machine.  Status is a property of the service.  One of the possible values for status is "Running", another value is "Stopped".  Should you wish to employ a 'where' clause, then you need the $\_. variable to introduce or link to the property 'status', hence $\_.status.

**Example to find all wmiobject containing 'CIM'**

get-wmiobject -list |where-object {$\_.name -like "CIM\*"}

**Note:** The point is that the list is too long when you try:
get-wmiobject -list

By pipelining $\_.name, we can filter just names containing "CIM".  Incidentally it does not work without the wildcard \* -like "CIM\*".

### 

To discover which version of PowerShell you are running,  go to the PowerShell command line and type:
$host

|     |     |
| --- | --- |
| **Variable Name** | **Description** |
| $\_ | The current pipeline object; used in script blocks, filters, the process clause of functions, where-object, foreach-object and switch |
| $^  | contains the first token of the last line input into the shell |
| $  | contains the last token of last line input into the shell |
| $?  | Contains the success/fail status of the last statement |
| $Args | Used in creating functions that require parameters |
| $Error | If an error occurred, the object is saved in the $error PowerShell variable |
| $foreach | Refers to the enumerator in a foreach loop. |
| $HOME | The user's home directory; set to %HOMEDRIVE%\\%HOMEPATH% |
| $Input | Input piped to a function or code block |
| $Match | A hash table consisting of items found by the –match operator. |
| $MyInvocation | Information about the currently script or command-line |
| $Host | Information about the currently executing host |
| $LastExitCode | The exit code of the last native application to run |
| $true | Boolean TRUE |
| $false | Boolean FALSE |
| $null | A null object |
| $OFS | Output Field Separator, used when converting an array to a string.<br>By default, this is set to the space character. |
| $ShellID | The identifier for the shell.  This value is used by the shell to determine the ExecutionPolicy and what profiles are run at startup. |
| $StackTrace | contains detailed stack trace information about the last error |

### 

In PowerShell, variables are easy to create, just precede the name with a dollar sign, for example $Disk.  For more ambitious scripting you can restrict their type for example \[int\]$Memory, you can also prescribe the variable's scope, local or global.

One variable worth mastering is the special pipeline variable controlled by $\_.

### See more Microsoft PowerShell tutorials:

• [PowerShell Home](http://www.computerperformance.co.uk/powershell/index.htm)  • [Com](http://www.computerperformance.co.uk/powershell/powershell_com.htm)  • [Shell Application](http://www.computerperformance.co.uk/powershell/powershell_com_shell.htm)  • [Active Directory](http://www.computerperformance.co.uk/powershell/powershell_active_directory.htm)  • [QAD Snap-in](http://www.computerperformance.co.uk/powershell/powershell_quest_qad.htm)  • [Get-Member](http://www.computerperformance.co.uk/powershell/powershell_get_member.htm)

Please write in if you see errors of any kind.  Please report any factual mistakes, grammatical errors or broken links, I will be happy to not only to correct the fault, but also to [give you credit](http://www.computerperformance.co.uk/powershell/credits.htm).

### [Download my ebook](http://www.computerperformance.co.uk/Poll/Sales_PowerShell.htm):[![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/ebook_powershell_include.gif]]](http://www.computerperformance.co.uk/Poll/Sales_PowerShell.htm)
Getting Started with PowerShell - only $9.25

You get 36 topics organized into these 3 sections:
   1) Getting Started
   2) Real-life tasks
   3) Examples of Syntax.

In addition to the ebook, you get a PDF version of this  [Introduction to PowerShell ebook](http://www.computerperformance.co.uk/Poll/Sales_PowerShell.htm)  It runs to 120 pages of A4.

  \*

* * *

|     |
| --- |
|     |
| [![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/Logo_25wht.gif]]](http://www.google.com/) |
| WebThis Site |

### [![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/ipsla_monitor_sm.jpg]]](http://www.solarwinds.com/register/index.aspx?Program=568&c=70150000000DsoD&CMP=LEC-PRT-CPUK-Body-I-DL)Free IP SLA Monitor

The IP SLA Monitor not only helps to discover network bottlenecks, but also teaches you about router traffic.  See how effortlessly this free monitor analyzes and displays the IP statistics.

The key to configuring is to select the data most relevant to your network, for example, ping echo, DNS resolution times, or HTTP statistics.  [Download a free copy of IP SLA Monitor](http://www.solarwinds.com/register/index.aspx?Program=896&c=70150000000ER88&CMP=BIZ-TAD-CMPP-IPSM-DL)

[Home](http://www.computerperformance.co.uk/index.htm) Copyright Â© 1999-2009 Computer Performance LTD All rights reserved

Please report a broken link, or an error. [guys@computerperformance.co.uk](mailto:guys@computerperformance.co.uk%3Fsubject=Site%20Problem)

* * *

![[./_resources/Microsoft_PowerShell_variables__The_$_._variable.resources/p-c4o0Sm0paaTJs.gif]]
